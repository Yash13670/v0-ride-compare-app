{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/v0-ride-compare-app/app/api/distance/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\n\ntype RequestBody = {\n  origin: string\n  destination: string\n}\n\nexport async function POST(request: Request) {\n  try {\n    const body: RequestBody = await request.json()\n    const { origin, destination } = body\n\n    if (!origin || !destination) {\n      return NextResponse.json({ error: 'origin and destination are required' }, { status: 400 })\n    }\n\n    const key = process.env.GOOGLE_MAPS_SERVER_KEY || process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY\n    if (!key) {\n      return NextResponse.json({ error: 'Server API key not configured' }, { status: 500 })\n    }\n\n    const params = new URLSearchParams({\n      origins: origin,\n      destinations: destination,\n      key,\n      units: 'metric',\n    })\n\n    const url = `https://maps.googleapis.com/maps/api/distancematrix/json?${params.toString()}`\n\n    const resp = await fetch(url)\n    if (!resp.ok) {\n      const t = await resp.text()\n      return NextResponse.json({ error: 'Google API error', details: t }, { status: 502 })\n    }\n\n    const data = await resp.json()\n\n    if (data.status !== 'OK' || !data.rows || !data.rows[0] || !data.rows[0].elements || !data.rows[0].elements[0]) {\n      return NextResponse.json({ error: 'No route data', details: data }, { status: 502 })\n    }\n\n    const element = data.rows[0].elements[0]\n    if (element.status !== 'OK') {\n      return NextResponse.json({ error: 'Route element error', details: element.status }, { status: 502 })\n    }\n\n    const distanceMeters = element.distance?.value ?? null\n    const durationSeconds = element.duration?.value ?? null\n\n    if (distanceMeters === null || durationSeconds === null) {\n      return NextResponse.json({ error: 'No distance/duration in response', details: element }, { status: 502 })\n    }\n\n    const distanceKm = Number((distanceMeters / 1000).toFixed(2))\n    const durationMin = Math.round(durationSeconds / 60)\n\n    return NextResponse.json({ distance_km: distanceKm, duration_min: durationMin })\n  } catch (err: any) {\n    return NextResponse.json({ error: 'Server error', details: String(err) }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAOO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAoB,MAAM,QAAQ,IAAI;QAC5C,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,GAAG;QAEhC,IAAI,CAAC,UAAU,CAAC,aAAa;YAC3B,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsC,GAAG;gBAAE,QAAQ;YAAI;QAC3F;QAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,sBAAsB;QAC9C;;QAIA,MAAM,SAAS,IAAI,gBAAgB;YACjC,SAAS;YACT,cAAc;YACd;YACA,OAAO;QACT;QAEA,MAAM,MAAM,CAAC,yDAAyD,EAAE,OAAO,QAAQ,IAAI;QAE3F,MAAM,OAAO,MAAM,MAAM;QACzB,IAAI,CAAC,KAAK,EAAE,EAAE;YACZ,MAAM,IAAI,MAAM,KAAK,IAAI;YACzB,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAoB,SAAS;YAAE,GAAG;gBAAE,QAAQ;YAAI;QACpF;QAEA,MAAM,OAAO,MAAM,KAAK,IAAI;QAE5B,IAAI,KAAK,MAAM,KAAK,QAAQ,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,EAAE,IAAI,CAAC,KAAK,IAAI,CAAC,EAAE,CAAC,QAAQ,IAAI,CAAC,KAAK,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE;YAC9G,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAiB,SAAS;YAAK,GAAG;gBAAE,QAAQ;YAAI;QACpF;QAEA,MAAM,UAAU,KAAK,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE;QACxC,IAAI,QAAQ,MAAM,KAAK,MAAM;YAC3B,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAuB,SAAS,QAAQ,MAAM;YAAC,GAAG;gBAAE,QAAQ;YAAI;QACpG;QAEA,MAAM,iBAAiB,QAAQ,QAAQ,EAAE,SAAS;QAClD,MAAM,kBAAkB,QAAQ,QAAQ,EAAE,SAAS;QAEnD,IAAI,mBAAmB,QAAQ,oBAAoB,MAAM;YACvD,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAoC,SAAS;YAAQ,GAAG;gBAAE,QAAQ;YAAI;QAC1G;QAEA,MAAM,aAAa,OAAO,CAAC,iBAAiB,IAAI,EAAE,OAAO,CAAC;QAC1D,MAAM,cAAc,KAAK,KAAK,CAAC,kBAAkB;QAEjD,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,aAAa;YAAY,cAAc;QAAY;IAChF,EAAE,OAAO,KAAU;QACjB,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;YAAgB,SAAS,OAAO;QAAK,GAAG;YAAE,QAAQ;QAAI;IAC1F;AACF"}}]
}